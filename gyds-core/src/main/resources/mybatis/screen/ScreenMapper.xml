<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.fly.screen.dao.ScreenDao">

	<select id="getOrgSurvey" resultType="java.util.Map">
		SELECT  type_name name,COUNT(*) value  from team t left join team_type tt on t.team_type = tt.id 
		<where>
		<if test="ids != null">
		         	and left(t.team_id,CHAR_LENGTH(#{ids})) LIKE CONCAT('%',#{ids},'%')  
		 </if>
		</where>
		GROUP BY t.team_type
	</select>
	<select id="getTeamByVolSurvey" resultType="java.util.Map">
		SELECT t.team_name name,COUNT(*) value from volunteer v INNER  JOIN team t on v.team_id=t.id 
		<where>
		<if test="ids != null">
		         	and left(v.team_id,CHAR_LENGTH(#{ids})) LIKE CONCAT('%',#{ids},'%')  
		 </if>
		</where>
		 GROUP BY v.team_id ORDER BY value desc
	</select>
	<select id="getNewsByTeamSurvey" resultType="java.util.Map">
		SELECT t.team_name name,COUNT(*) value from new_info n INNER  JOIN team t on n.team_id=t.id 
		<where>
		<if test="ids != null">
		         	and left(n.team_id,CHAR_LENGTH(#{ids})) LIKE CONCAT('%',#{ids},'%')  
		 </if>
		</where>
		 GROUP BY n.team_id ORDER BY value desc
	</select>
	<select id="getCreateTeamSurvey" resultType="java.util.Map">
		SELECT count(*) value from team 
		<where>
		<if test="starteTime != null">
		and create_time &gt;= #{starteTime}
		</if>
		<if test="endTime != null">
		and create_time &lt;= #{endTime}
		</if>
		<if test="ids != null">
		         	and left(id,CHAR_LENGTH(#{ids})) LIKE CONCAT('%',#{ids},'%')  
		 </if>
		</where>
	</select>
	
	<select id="getPublicNewsSurvey" resultType="java.util.Map">
		SELECT count(*) value from new_info 
		<where>
		<if test="starteTime != null">
		and create_time &gt;= #{starteTime}
		</if>
		<if test="endTime != null">
		and create_time &lt;= #{endTime}
		</if>
		<if test="ids != null">
		         	and left(team_id,CHAR_LENGTH(#{ids})) LIKE CONCAT('%',#{ids},'%')  
		 </if>
		</where>
	</select>
	
	<select id="getPublicNewsMon" resultType="java.util.Map">
		SELECT count(*) value,MONTH(create_time) name from new_info 
		<where>
		<if test="starteTime != null">
		and create_time &gt;= #{starteTime}
		</if>
		<if test="endTime != null">
		and create_time &lt;= #{endTime}
		</if>
		<if test="ids != null">
		         	and left(team_id,CHAR_LENGTH(#{ids})) LIKE CONCAT('%',#{ids},'%')  
		 </if>
		</where>
		 GROUP BY MONTH(create_time)
	</select>
	
	<select id="getPublicNewsCount" resultType="java.util.Map">
		SELECT count(*) value from new_info 
		<where>
		<if test="starteTime != null">
		and create_time &gt;= #{starteTime}
		</if>
		<if test="endTime != null">
		and create_time &lt;= #{endTime}
		</if>
		<if test="ids != null">
		         	and left(team_id,CHAR_LENGTH(#{ids})) LIKE CONCAT('%',#{ids},'%')  
		 </if>
		</where>
	</select>
	
	<select id="getPublicActTypeSurvey" resultType="java.util.Map">
		SELECT count(*) value, t.type_name name from activity a left join act_type t on a.act_type_id = t.id
		<where>
		 <if test="ids != null">
		         	and left(team_id,CHAR_LENGTH(#{ids})) LIKE CONCAT('%',#{ids},'%')  
		 </if>
		</where>
		 GROUP BY name
	</select>
	<select id="getPublicActivitySurvey" resultType="java.util.Map">
		SELECT count(*) value from activity 
		<where>
		<if test="starteTime != null">
		and create_time &gt;= #{starteTime}
		</if>
		<if test="endTime != null">
		and create_time &lt;= #{endTime}
		</if>
		 <if test="ids != null">
		         	and left(team_id,CHAR_LENGTH(#{ids})) LIKE CONCAT('%',#{ids},'%')  
		 </if>
		</where>
	</select>
	
	<select id="getPoliticsSurvey" resultType="java.util.Map">
		SELECT  political_status name,COUNT(*) value  from sys_user  
		<where>
		<if test="ids != null">
		         	and left(t.team_id,CHAR_LENGTH(#{ids})) LIKE CONCAT('%',#{ids},'%')  
		 </if>
		</where>
		GROUP BY political_status
	</select>
	<select id="getEducationSurvey" resultType="java.util.Map">
		SELECT  education name,COUNT(*) value  from sys_user  
		<where>
		<if test="ids != null">
		         	and left(t.team_id,CHAR_LENGTH(#{ids})) LIKE CONCAT('%',#{ids},'%')  
		 </if>
		</where>
		GROUP BY education
	</select>
	<select id="getPostSurvey" resultType="java.util.Map">
		SELECT  post name,COUNT(*) value  from sys_user  
		<where>
		<if test="ids != null">
		         	and left(t.team_id,CHAR_LENGTH(#{ids})) LIKE CONCAT('%',#{ids},'%')  
		 </if>
		</where>
		GROUP BY post
	</select>
	<select id="getSexCount" resultType="java.util.Map">
		SELECT  sex name,COUNT(*) c  from sys_user  
		<where>
		<if test="ids != null">
		         	and left(t.team_id,CHAR_LENGTH(#{ids})) LIKE CONCAT('%',#{ids},'%')  
		 </if>
		</where>
		GROUP BY sex
	</select>

</mapper>