<!DOCTYPE html>
<html>
<meta charset="utf-8">
<head th:include="include :: header"></head>
<body class="gray-bg">
	<div class="wrapper wrapper-content ">
		<div class="row">
			<div class="col-sm-12">
				<div class="ibox float-e-margins">
					<form class="form-horizontal m-t" id="signupForm">
						<div class="ibox-content">
							<div class="form-group">
								<input type="hidden" th:value="${newsId}" name="newsId">
								<label class="col-sm-2 control-label">置顶开始时间：<span
									class="text-danger">*</span></label>
								<div class="col-sm-8">
									<input type="text" class="laydate-icon layer-date form-control"
										id="topStartTime" name="topStartTime" placeholder="请选择置顶开始时间"
										onclick="laydate({istime: true, format: 'YYYY-MM-DD',min:'0',min: laydate.now(1, 'YYYY-MM-DD ')})"
										style="background-color: #fff;" />
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label">置顶结束时间：<span
									class="text-danger">*</span></label>
								<div class="col-sm-8">
									<input type="text" class="laydate-icon layer-date form-control"
										id="topEndTime" name="topEndTime" placeholder="请选择置顶结束时间"
										onclick="laydate({istime: true, format: 'YYYY-MM-DD',min: laydate.now(1, 'YYYY-MM-DD ')})"
										style="background-color: #fff;" />
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label">置顶地区：<span
									class="text-danger">*</span></label>
								<div class="col-sm-8">
									<label class="radio-inline"> <input type="radio"
										onchange="count()" th:value="${region}" name="regionCode">本平台
									</label> <label class="radio-inline"> <input type="radio"
										onchange="count()" th:value="${proRegion}" name="regionCode">本省
									</label> <label class="radio-inline"> <input type="radio"
										onchange="count()" th:value="${cityRegion}" name="regionCode">本市
									</label> <label class="radio-inline"> <input type="radio"
										onchange="count()" th:value="${areaRegion}" name="regionCode">本县(区)
									</label> <label class="radio-inline"> <input type="radio"
										onchange="count()" th:value="${teamRegion}" name="regionCode">本团
									</label>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label">费用(单位:元)：<span
									class="text-danger"></span></label>
								<div id="countMon"></div>
							</div>
							<div class="col-sm-8 col-sm-offset-3">
								<button type="submit" class="btn btn-primary" onclick="saveTop()">提交</button>
							</div>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
	</div>
	<div th:include="include::footer"></div>
	<script type="text/javascript">
		function saveTop() {
			$.ajax({
				type : "POST",
				url : "/pc/news/topInfo",
				data : $('#signupForm').serialize(),// 你的formid
				dataType: "json",
				async: false,
				error : function(request) {
					parent.layer.alert("置顶申请失败");
				},
				success : function(data) {
					console.log(data);
					alert("0");
					if (data.code == 0) {
						console.log(000);
						parent.layer.msg("置顶申请成功");
						///history.go(0);
						var index = parent.layer.getFrameIndex(window.name); // 获取窗口索引
						parent.layer.close(index);

					} else {
						parent.layer.alert(data.msg)
					}

				}
			});

		}

		function count() {
			var params = {};
			params = {
				"topStartTime" : $('#topStartTime').val(),
				"topEndTime" : $('#topEndTime').val(),
				"regionCode" : $('input:radio:checked').val()
			};
			$.ajax({
						type : "POST",
						url : "/pc/news/count",
						data : params,// 你的formid
						error : function(request) {
							parent.layer.alert("请填写正确的开始时间 结束时间与置顶区域");
						},
						success : function(data) {
							$('#countMon').empty();
							var a = '<div class="col-sm-8"><input class="form-control" value = '+data.count+' type="text"></div>';
							$('#countMon').append(a);
						}
					});
		}
	</script>
</body>

</html>
