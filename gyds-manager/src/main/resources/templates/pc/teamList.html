<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title th:text="${'团队展示-'+title}"></title>
		<link rel="stylesheet" type="text/css" href="css/index.css"/>
		<script src="js/jquery-3.1.1.js"></script>
		<link rel="stylesheet" href="css/activity.css">
		<link rel="stylesheet" href="css/Volunteer.css">
	</head>
	<body>
		<!-- 头部 -->
		<div th:replace="pc/include :: header"></div>
		<div style="width: 1200px;margin:0 auto;line-height:70px; font-size:14px;color:#aaaaaa;">您所在的位置：首页>团队展示</div>
		<input type="hidden" th:value="${areaId}" id="areaId">
		<div class="team" id ="team">
			<figure th:each="team : ${teamList}">
				<a th:href="@{/pc/teamDetail(teamId=${team.id},areaId=${areaId})}"><img th:src="${team.teamTitleImg}" alt=""></a>
				<figcaption th:text="${team.teamName}"></figcaption>
				<p th:text="${team.level.levelname}" style="color: #c01b25;font-size: 14px;"></p>
			</figure>
		</div>
		<!-- 底部 -->
		<div th:replace="pc/include :: footer"></div>
	</body>
	<script th:src="@{/pc/js/common.js}"></script>
	<script>
	function _area(){
		console.log($("#area").val());
		window.location.href = "/?areaId="+$("#area").val();
	}
	
	
	//分页加载
	
$().ready(function(){
var areaId = $('#areaId').val();
var hasMore;
var page = 1; //初始页码
var maxnum = 2;//设置加载次数
 
var downrange= 100;                //下边界-参考正在加载提示层/px
var $main = $("#showbox");            //主体
var $loaddiv = $("#add-more") ;       //加载提示层
var totalheight = 0; 
var $listrow=$("#team");
//ajax-fun
function ajaxLoad(){
var html="";
page=page+1;//每次拉到底部page加1
//console.log(page)
hasMore=false;
$.ajax({
url:"/pc/queryTeamList?areaId="+areaId+"",
type:"post",
data:{page:page},//请求页数
success:function(res){
var list = eval(res);
//console.log(list.length);
//var list=JSON.parse(res);
if(list.length>0) {
    hasMore=true;
//console.log(JSON.parse(res));
    //追加数据
   $.each(res, function(i, item){ 
	html += '<figure>';
	html += '<a href="/pc/teamDetail?teamId='+item.id+'&areaId='+areaId+'"><img src="'+item.teamTitleImg+'"></a>';
	html += '<figcaption>'+item.teamName+'</figcaption>';
	html += '</figure>';
    })
    $listrow.append(html);//数据追加到list
    var imgWidth=$('.list_flex_son_img').width();
    $('.list_flex_son_img').height(imgWidth);
}    
}
})
}
 
//加载中隐藏显示
$loaddiv.ajaxStart(function(){
$(this).show();
}).ajaxStop(function(){
$(this).hide();
})
ifLoad();
//scroll滚动触发加载事件
function ifLoad(){
hasMore=true;
var w = $(window);
var lastTime = new Date();
window.addEventListener("scroll", function scrollHandler() {
var scrollh = $(document).height();
var bua = navigator.userAgent.toLowerCase();
if (bua.indexOf('iphone') != -1 || bua.indexOf('ios') != -1) {
scrollh = scrollh -140;
} else {
scrollh = scrollh - 80;
}
if(($(document).scrollTop() + w.height()) >= scrollh){
if (new Date()-lastTime <100) {
    return;
}
lastTime = new Date();
if (hasMore) {
    ajaxLoad();
}
}
}, 1000);
}
 
});

</script>
</html>
