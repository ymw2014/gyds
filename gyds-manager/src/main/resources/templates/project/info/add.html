<!DOCTYPE html>
<html>
<meta charset="utf-8">
<head th:include="include :: header"></head>
<body class="gray-bg">
	<div class="wrapper wrapper-content ">
		<div class="row">
			<div class="col-sm-12">
				<div class="ibox float-e-margins">
					<div class="ibox-content">
						<form class="form-horizontal m-t" id="signupForm">
							<div class="form-group">	
								<label class="col-sm-3 control-label">项目名称：</label>
								<div class="col-sm-8">
									<input id="projectName" name="projectName" class="form-control" type="text">
								</div>
							</div>
														<div class="form-group">	
								<label class="col-sm-3 control-label">项目类型：</label>
								<div class="col-sm-8">								
									<select id="projectType" name="projectType" class="form-control" onchange="queryCost()">
											<option value="0">请选择</option>
											<option th:each="type:${type}" th:value="${type.id}" th:text="${type.projectTypeName}"></option>
									</select>
										<span style="color: red;">发布项目需支付:<span id="cost1" >0</span>元	</span>	
										<input type="hidden" name="cost" id="cost">						
								</div>
							</div>
														<div class="form-group">	
								<label class="col-sm-3 control-label">项目LOGO：</label>
								<div class="col-sm-8">
								<div>
				   					 <a href="javascript:;" class="btn btn-primary btn-sm jqfivefile" type="button">
								        <span id="imgUpload_name_img">上传图片</span><span id="progress_img"></span>
								        <input id="imgUpload_img" type="file"  title="上传图片" name="file" accept="image/*" data-url="/common/sysFile/upload" />
								    </a>
								    <div id="imgsbox_img" class="imgsbox">
								    </div>
						       </div>
								
								</div>
							</div>
														<div class="form-group">	
								<label class="col-sm-3 control-label">承接费用：</label>
								<div class="col-sm-8">
									<input id="tickets" name="tickets" class="form-control" type="text">
								</div>
							</div>
														<div class="form-group">	
								<label class="col-sm-3 control-label">简介：</label>
								<div class="col-sm-8">
									<textarea id="intro" name="intro"></textarea>
								</div>
							</div>
																					<div class="form-group">
								<div class="col-sm-8 col-sm-offset-3">
									<button type="submit" class="btn btn-primary">提交</button>
								</div>
							</div>
						</form>
					</div>
				</div>
			</div>
	</div>
	</div>
	<div th:include="include::footer"></div>
	<script type="text/javascript" src="/js/appjs/project/info/add.js"></script>
	<script type="text/javascript" src="/ueditor/ueditor.config.js"></script>
	<script type="text/javascript" src="/ueditor/ueditor.all.js"></script>
	<script type="text/javascript" src="/ueditor/lang/zh-cn/zh-cn.js"></script>
	
<script type="text/javascript">
var ue = UE.getEditor('intro',{
	toolbars:[
        [
     	   'fullscreen', 'source', '|', 'undo', 'redo', '|',
     	    'bold', 'italic', 'underline', 'fontborder', 'strikethrough', 'superscript', 'subscript', 'removeformat', 'formatmatch', 'autotypeset', 'blockquote', 'pasteplain', '|', 'forecolor', 'backcolor', 'insertorderedlist', 'insertunorderedlist', 'selectall', 'cleardoc', '|',
     	    'rowspacingtop', 'rowspacingbottom', 'lineheight', '|',
     	    'customstyle', 'paragraph', 'fontfamily', 'fontsize', '|',
     	    'directionalityltr', 'directionalityrtl', 'indent', '|',
     	    'justifyleft', 'justifycenter', 'justifyright', 'justifyjustify', '|', 'touppercase', 'tolowercase', '|',
     	    'link', 'unlink', 'anchor', '|',
     	    'insertimage', 'emotion', 'map', 'insertframe', 'insertcode', 'pagebreak', 'background', '|',
     	    'horizontal', 'date', 'time', 'spechars', '|',
     	    'print', 'preview', 'searchreplace', 'drafts', 'help'
     ]
 ]
});



$(function(){
    var multi = 0;
    var name = "logo";
    if(multi){
        name = name+'[]';
        $("#imgUpload_img").attr('multiple','multiple');
    }else{
        $("#imgUpload_img").removeAttr('multiple');
    }
    
    $("#imgUpload_img").fileupload({
        dataType: 'json',
        done: function (e, data) {
            	console.log(data.result);
            if (data.result.code == 0) {
                var img = '<div class="imgbox">';
                img += '<div class="removePic" onclick="removePic(this,\'/banner/imgDel\')">×</div>';
                img += '<input type="hidden" name="'+name+'" value="' + data.result.fileName + '">';
                img += '<img src="' + data.result.fileName + '">';
                img += '</div>';
                if(multi){
                    $("#imgsbox_img").append(img);
                }else{
                    $("#imgsbox_img").html(img);
                }
            } else {
                layer.msg(data.msg);
            }
        },
        change: function (e, data) {
            $("#imgUpload_name_img").html('上传图片...');
        },
        progressall: function (e, data) {
            var progressnum = parseInt(data.loaded / data.total * 100);
            if (progressnum == 100) {
                $("#progress_img").text('');
                $("#imgUpload_name_img").html('上传图片');
            } else {
                $("#progress_img").text(progressnum + "%");
            }
        },
        error: function(e,data){
            layer.msg('上传请求失败');
        }
    });
});

/**
 * 移除图片
 */
function removePic(_self,deleteurl){
    $(_self).parent().remove();
    if(deleteurl){
        $.post(deleteurl,{path:$(_self).parent().find('img').attr('src')});
    }
}

function queryCost(){
	var id = $("#projectType option:selected").val();
	if(id != 0){
	$.ajax({
		type : "POST",
		url : "/project/type/queryCost?id="+id,
		error : function(request) {
			parent.layer.alert("Connection error");
		},
		success : function(data) {
			if (data.code == 0) {
				var cost = data.cost==null?0:data.cost;
				$('#cost').text(cost);
				$('#cost1').text(cost);
			} else {
				parent.layer.alert(data.msg)
			}
		}
	});
	}else{
		$('#cost1').text(0);
		$('#cost').text(0);
	}
}
</script>
</body>
</html>
