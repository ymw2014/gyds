<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<meta name="viewport" content="width=750">
		<link rel="stylesheet" th:href="@{/mobile/css/wodeguanzhu.css}">
		<script type="text/javascript" th:src="@{/mobile/js/jquery-3.1.1.js}"></script>
		<script type="text/javascript" th:src="@{/mobile/js/jquery-1.10.1.min.js}"></script>
		<script type="text/javascript" th:src="@{/mobile/js/mobile-util.js}"></script>
		<script th:src="@{/js/plugins/layer/layer.js}"></script>
		<script th:src="@{/js/layui.js}"></script>
		<style>
			.remover{
				width: 27px;
				height:30px;
				position:absolute;
				right:30px;
				bottom:7px;
			}
			.biaotiyy{
				width:95%;
				margin-left:2.5%;
				margin-top:30px;
			}
			.biaotiyy label>span{
				line-height:92px;
				display:inline-block;
				float: left;
				font-size:30px;
				margin-right:18px;
				color:#b8b8b8;
			}
			.biaotiyy label{
				display: block;
				overflow: hidden;
				border-bottom: 1px solid #f4f4f4;
			}
			.biaotiyy input{
				line-height:92px;
				width:630px;
				display:inline-block;
				float: left;
				border:none;
				outline:none;
				font-size:30px;
				color:#333;
			}
			.fang{
				float: left;
				border:1px dashed #bdbdbd;
				padding: 10px;
			}
			.mstp{
				overflow: hidden;
				padding: 20px;
			}
			.mstp>div>img{
				width: 122px;
				height: 122px;
				margin-right:20px;
			}
			.mstp>div{
				float: left;
				position: relative;
			}
			.mstp>div>span{
				display: block;
				width: 30px;
				height: 30px;
				position: absolute;
				top:-10px;
				right:10px;
				text-align: center;
				line-height:30px;
				background:#f98185;
				color:#fff;
				border-radius:50%;
			}
			.lxh{
			  width: 539px;
			    height: 90px;
			    border: none;
			    outline: none;
			    font-size: 20px;
			    background:#fff;
			}
			.tijiao{
				width: 100%;
				height:80px;
			}
			.tijiao>input{
				width: 100%;
				height:80px;
			    line-height:80px;
				background:#ff0000;
				color:#fff;
			}
		</style>
	</head>
	<body>
		<div class="mygz">
			<div class="alendar"> 
				<a href="javascript:history.back(-1)"><img th:src="@{/mobile/images/qianwnag.png}" alt=""></a>
				<span>新闻发布</span>
			</div>
		</div>
		<div class="biaotiyy">
			<form id="signupForm">
				<label>
					<span>标题</span>
					<input name="title" type="text" required="required" autocomplete="off" >
				</label>
				<label>
					<span>作者</span>
					<input type="text" name="author" required="required" autocomplete="off">
				</label>
				<label th:if="${#lists.size(listMap)} gt 0">
						<span>承接项目</span>
						<select name="projectId" class="lxh">
							<option value="0">--请选择--</option>
							<option th:each="map:${listMap}" th:text="${map.name}" th:value="${map.id}"></option>
						</select>
					</label>
				<!-- <label>
					<span>来源</span>
					<input type="text" name="source" required="required" autocomplete="off">
				</label> -->
				<!-- <label>
					<span>简介</span>
					<textarea name="introduction" style="width: 588px;height: 115px;margin-top:20px;border: none;outline:none;" required="required"></textarea>
				</label> -->
				<label style="margin-top:30px;">
						<span style="float: left;">封面</span>
						<img src="images/gahgha_03.png"  height="200" width="500" alt="" id="img">
						<input type="hidden" id="img1" name="titleImg">
						<input type="file" name="file" style="display: none;" id ="file" required="required">
				</label>
				<label>
					<span>
						详情
					</span>
					<textarea name="content" id="deitor" style="width: 588px;height: 325px;margin-top:20px;border: none;outline:none;" required="required">
					</textarea>
				</label>
			   
			   <div class="tijiao">
				   <input type="button" id="save"  value="立即发布">
			   </div>
			</form>
			<div style="background:#fff;display: none"  id="info">
					<div class="tijiaohou">
						<img src="/pc/images/hsusus_03.jpg" alt="">
						<p>已提交，请耐心等待后台审核，谢谢配合！</p>
						<a href="/pc/persion_main">完成</a>
					</div>
				</div>
		</div>
	</body>
	 <script type="text/javascript" src="/ueditor/ueditor.config.js"></script>
	<script type="text/javascript" src="/ueditor/ueditor.all.js"></script>
	<script type="text/javascript" src="/ueditor/lang/zh-cn/zh-cn.js"></script>
	 <script th:src="@{/js/plugins/validate/jquery.validate.min.js}"></script>
	 <script th:src="@{/js/plugins/validate/messages_zh.min.js}"></script>
	 <script th:src="@{/js/validate.js}"></script>
	<script type="text/javascript">
	
	var ue = UE.getEditor('deitor',{
		toolbars:[
	        [
	     	    '|', 'undo', 'redo', '|',
	     	     'fontfamily', 'fontsize', '|',
	     	    'justifyleft', 'justifycenter', 'justifyright', 'justifyjustify', '|',
	     	    'link', 'unlink', 'anchor', '|',
	     	    'insertimage', 'emotion', 'map','background', '|',
	     	    'horizontal', 'date', 'time', 'spechars'
	     ]
	 ]
	});
	$(".sctp1").click(function(){
		$(".sctp11").click();
	})
	$(".sctp2").click(function(){
		$(".sctp22").click();
	})
	
	
	layui.use('upload', function() {
            var upload = layui.upload;

            //执行实例
            var uploadInst = upload.render({
                elem : '#file', //绑定元素
                url : '/common/sysFile/upload', //上传接口
                size : 1000,
                accept : 'file',
                done : function(r) {
                    var fileName = r.fileName;
                     $("#img1").val(fileName);
             	     $("#img").attr("src",fileName);
                },
                error : function(r) {
                    layer.msg(r.msg);
                }
            });
            
        });
	
	
	function save() {
		$.ajax({
			type : "POST",
			url : "/pc/newSave",
			data : $('#signupForm').serialize(),
			success : function(r) {
				if (r.code == 0) {
					$("#signupForm").hide();
					$("#info").show();
				} else {
					layer.msg(r.msg)
				}
			},
		});
	}
	
</script>
<script type="text/javascript">
$().ready(function(){
	$("#save").on('click', function() {
		$("#signupForm").submit();
	});
})
$().ready(function() {
	validateRule();
});

$.validator.setDefaults({
	submitHandler : function() {
		save();
	}
});
function validateRule() {

	var icon = "<i class='fa fa-times-circle'></i> ";
	$("#signupForm").validate({
		rules : {
			title : {
				required : true
			},
			author : {
				required : true
			},
			content : {
				content : true
			}
		},
		messages : {
			title : {
				required : icon + "<span style='color:red;position: absolute;margin-top: 44px;margin-left: -623px;font-size: 26px;'>标题不能为空 !</span>",
			},
			author : {
				required : icon + "<span style='color:red;position: absolute;margin-top: 44px;margin-left: -623px;font-size: 26px;'>请输入新闻作者 !</span>",
			},
			content : {
				required : icon + "<span style='color:red;position: absolute;margin-top: 44px;margin-left: -623px;font-size: 26px;'>新闻内容不能为空 !</span>",
			}
		}
	})
}
</script>

	
</html>
	